/home/liuwei/mnt/vggt/pi3-liuwei/train_sky.py:549: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=args.amp):
[sky stage] Epoch 1 Iter 0/800 loss_sky=0.034928
[sky stage] Epoch 1 Iter 1/800 loss_sky=0.034435
[sky stage] Epoch 1 Iter 50/800 loss_sky=0.015456
[sky stage] Epoch 1 Iter 100/800 loss_sky=0.000883
[sky stage] Epoch 1 Iter 150/800 loss_sky=0.000052
[sky stage] Epoch 1 Iter 200/800 loss_sky=0.000021
[sky stage] Epoch 1 Iter 250/800 loss_sky=0.000011
[sky stage] Epoch 1 Iter 300/800 loss_sky=0.000006
[sky stage] Epoch 1 Iter 350/800 loss_sky=0.000004
[sky stage] Epoch 1 Iter 400/800 loss_sky=0.000003
[sky stage] Epoch 1 Iter 450/800 loss_sky=0.000002
[sky stage] Epoch 1 Iter 500/800 loss_sky=0.000002
[sky stage] Epoch 1 Iter 550/800 loss_sky=0.000001
[sky stage] Epoch 1 Iter 600/800 loss_sky=0.000001
[sky stage] Epoch 1 Iter 650/800 loss_sky=0.000001
[sky stage] Epoch 1 Iter 700/800 loss_sky=0.000001
[sky stage] Epoch 1 Iter 750/800 loss_sky=0.000001
/home/liuwei/mnt/vggt/pi3-liuwei/train_sky.py:454: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
[Epoch 1] âœ… Validation done: loss=0.000011, IoU=0.8288
Process SpawnProcess-1:
Traceback (most recent call last):
  File "/home/liuwei/anaconda3/envs/pi3-liuwei/lib/python3.10/site-packages/torch/multiprocessing/spawn.py", line 90, in _wrap
    fn(i, *args)
  File "/home/liuwei/mnt/vggt/pi3-liuwei/train_sky.py", line 584, in train_worker
    save_file(model.module.state_dict(), ckpt_path)
  File "/home/liuwei/anaconda3/envs/pi3-liuwei/lib/python3.10/site-packages/safetensors/torch.py", line 352, in save_file
    serialize_file(_flatten(tensors), filename, metadata=metadata)
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liuwei/anaconda3/envs/pi3-liuwei/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/home/liuwei/anaconda3/envs/pi3-liuwei/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/liuwei/anaconda3/envs/pi3-liuwei/lib/python3.10/site-packages/torch/multiprocessing/spawn.py", line 90, in _wrap
    fn(i, *args)
  File "/home/liuwei/anaconda3/envs/pi3-liuwei/lib/python3.10/site-packages/torch/utils/data/_utils/signal_handling.py", line 73, in handler
    _error_if_any_worker_fails()
RuntimeError: DataLoader worker (pid 2899282) is killed by signal: Interrupt.
